---
title: '[Re] Local alignment statistics - EVD data exploration'
author: "Nathan Brouwer"
date: "11/18/2019"
output:
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data exploration

Sample analysis and exploration of n = m = 191 data

Load the data
```{r}
random.scores.191 <- read.csv(file = "random_scores_191.csv")
```


### Distribution of scores

The scores produced by the simulation are similar in shape to an extreme value distribution (EVD)
```{r}

head(random.scores.191$score.i)

```

We can make the graph a bit smoother by setting breaks = 20, which determines the number of bars in the histogram
```{r}

hist(random.scores.191$score.i,
     breaks = 20)

```


If we want we can make R give each score its own bar on the histogram.  The code below does this, but is a bit dense and I won't explain it
```{r}
x <- range(random.scores.191$score.i)
bins <- x[2]-x[1]+1
hist(random.scores.191$score.i,
     breaks = bins,
     xlab = "scores")
```



### Determining the mode

The Gumbel extreme value distribution has two parameters: mu and lambda.  

mu is defined as the highest point of the distribution.  This is similar to the **mode** of the distribution.  We can therefore approximate mu by calculate the mode.  We can get the mode using the table() function, followed by some processing 

Make a table of the scores
```{r}
table.i <- table(random.scores.191$score.i)
table.i
```

I can use which.max() to figure out which element of the table has the highest value.
```{r}
i.max <- which.max(table.i)
table.i[i.max]
```

The scores are actually scored as the names of the table elements.  I can get them using names()
```{r}
mode.i <- names(table.i[i.max])
mode.i
```

Names are character data so I use as.numeric() to turn it into a numeric value
```{r}
mode.i <- as.numeric(mode.i)
mode.i
```

I can now make a histogram with the mode shown.  abline() with v = mode.i puts a line at the mode.
```{r}
hist(random.scores.191$score.i, 
     breaks = bins,
     xlab = "scores")
abline(v = mode.i, col = 2, lwd = 4, lty = 2)
```



```{r}

```

