---
title: "Untitled"
author: "Nathan Brouwer"
date: "10/19/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```





```{r}

```




```{r}
summary(random.scores)
```





```{r}
x <- "KKIYHGSSVDPKSANNELTAVGPIGTALSLRLVGSGDCLTSFGLAIFPAMFVSGHYILTHLHLRWNSSFARFVLLVLPLPIKASAEGVSFPKREADRFRGEYSLGIADKLKEVVPEGRNVPMNWESLCMESWARPICGNPSVSEWAEFGLEWKVNRLDIEDNILIYMSSPPRTDATTGLAGGRIHTGREMLPPAIFFLCLEVMLGMELNTTGAGYKKFEAHNAERHKFENGHECLREETPEDGSAISLVEPFFLTIDGMRDIASVNDTLKTEALTGDEICYEGADWKRTIVTTNTSDESDHRTCEETPYGKEYSADSRYLVAVTGESLDESSSSYVSPLRDFYHAIFASPKHDCGGKNSGAFVYETSYYITTRIKENADLRRDDLNGLSAMCWPSVCNIATLIPPKMLELVCIETGDDLVNAKLMRTIVTRNRDGENAFKLKVAVPVEDSDKKLCRKMAVSDPLGNSGDDIGNSGISLHGTGLEFNTAPGASNRMRGTRKGVTMFYFFAKAGDYPGMDTCGDAVSNMNRAGKPKARASDAILPPISKTDSGSARAGEGSRALLTYGTKMPTLHVDNEHDGTFYPMPGTESGGNKEGDDKKETINLSKSVSTFSEANASDTTEMYECSKSRLGRGSASVEKSASDASERPLKGVYRIEYVEYETDRKEKLRFSNKIRKKRRFPAIAEAYGCDCDPDRCDEWEELHWVTREETIVESSFGKSALKIEAGFYHSCPAGKVALKNTNATEAMACPVDERRSKKICPGDMSNMGEVRLIPSMNSDALYNLADGTIIIMPLYSILEADKDRMNKLGAPEDPGEDVIASSWKIEEIFEEGFLAWTNISCKAEGGSYRRIGLKTMKEEAYIPRPRTEVLMKVVVDRLNPENARIRATPDGFATDIMVYTNALGIPFKDSLERCKPPKLRNNMASFVTRFAHDLRRHPTRCIRGKGMGGYGFEIKEDPGSSKRSYASNGIVRKDARGPEIRKALNRNDAITPAAVAFSSAESNLLTPTLSNITDVEENGAYEKESDVLVREVIPTLKRAPVGMDYPEAVDVTKRLLPTGGDTSANVDREAPELLLVVRIDEKGFIYCAIRIVHDRTIPIAGNTGFKGLMLPTAGFNPGGVRANNDVKNWFLPDLAAYVANWNSATIVYIFATAKLRKKDCRFAEKRPDLTKDNPEPDIPIYRGDMPEPPSMGFKRINDLAANDVAGSCEEERGLIALFKLYATNKGYNSDNEYADSHGPIPHRIRVPGCGREARGFCRYNVEASVGFATAYIMTGKIASLAEFVENSNELAYERLGDLGVFRDLTAAANTFACSNPKTALVLDDISVHGTGSLGATVSEFCGDTFLVYVSILWACAGAALDINRTKFYGTGGSNGADEARYASSGIKGHSFEGTENKGSAVGANWGMKGDVKSPTMTMMSGYDVVALTIRLVPGTRIFMDTECGVALGSYSHTSILDALYKVETSNGLDLGKNRGSNRDYPGANREIITNEEMDVRKHAGCKSVCPLEALLNAGSVGVEFIMVSKAEKLLHKIRGVGRTDSIDTELGIVYTPGTEDSVTINGYEETEPDLGNSKERSIKTDGHELTDAELRESKKNLYWSRGPPASEVERFVEDPRKPPVHTGGASGNELPYYNRSGLSGPYTPIELDSGSELEPNHMAEHWMLKGLDEEPASFDDLICESTENVWRGMFKLENNAIDAAVLTLTDGVKKALKLPSILVKYEYRWGEPDSIGGTLVTTTKALSIERTITNAKRVKNATFDSVVSADTSNIVIIGTSYVFAEAPGSTRKYNNGWVGEEIDGACSDDAITHDKISAEVSSSGKMDDPCLMDDSSTSVKPSKACIKVGCSCDPFAAVRGCTTPTNSGTFANIAYGWNEGGLPYCKVRTCMSGTHCYATEWYEKVGPEKTRAPGNFEYADNVMTFFEPMRPKWRVRLYYAKHPNMLLGVISAIITGEAWKEGNVGRMLNAFVDKLAGRPKVANGLMLSIGDTAMSPFGGKNLAYGYYVKTGRESREVRGKMLEGVSITTPLPELDCDKGHMIEVRPVLSFTYTVVRVARHVAVSGPAGGKICNGDTGRNPCNNISLSRLEPKFMGCNKCPTVGSYSGSNLEVPNAGLEIVHSIGYDLLIPAYPRDKRKAPGRHPSSDDCLLNLLWAMISPEVDVARVVPDPAYAVVAELIRKCVEVETPCTSAIIIYTFELGGFMCVLDDATEEYASEARHSKLKECGSGKRYALFAVHRTWVYGIRRVSGSLKPADAYDPNTSNLMATSTTSVEHVVYGESKFHSDVVFLTPGGKEKTEGAVLDLNNDPPLGVFKLARTLVAIGKTNPGYRPSGACKSPWLYGNSARAAFAVGGERESIDVATILTMIRASYPSTKATWHMHYCTGNIVAKSLLLATLITGEAVYRASSTKYIVRESSATPAGRAILASKYDEKLVGVPVGRDALGISPFKPKPVDHTYTIMVLVDIKKEKVRTFADSIVMSFPRGIPSGKMTDKLPTLSHALDSYYTDHPAGKLPPYRIMLGLEDLMTINPPAVADDSDDGLRLAKDKMRTHDAEDPKRLSNPKLSKCMSKAGFEFGLSDERNLLGPFRGLTFPTAGPGSAHKLNIREEDGRLSCAIVLKVLMDFVVKCVPAKTRNGVEFTIATMAKNMALDGALVMCPIVDKKVAVSPRLNLLESEGNCCKRSCKYITFNSDKRSVIVKDGKVINELSLFNLTYAESFTRPAHLVLSEEGNRGDAVKSVLRSVVLKVLNLVVKLAGAWHKVGVMAPKRYAGIDEFGIWEKFVRDLVAKFFGRVMESSAKDNTGKEFGKVYLASAKMRSCLRLRKYIELRGERHRTPNFVLTLGVGVERLSTLISISYYYGGETEVLGRTKIIVKHGIPHLMDSARAGRGHLIAASEGIRDAIHFVDRNCGAFLKNPIKDAGMSIKCSYTANLGRSKIASVNERGGGKLKGKGLDTKEERFYGRGDIERFVEETRRLVPLLG"

y <- "GVAVASGFLPKGASTWISIMNFKLSSEINLMYTGDLNTLSTTCGHDRAILTDGNAVKAKDRVSVGYWKKTLREKAGCIINLHYYCRLTGHWVDAVLPLVFGLHSESFCKSPGALEKDILKKHCTSSMSFIGDKMEFELLNDDKVKGKEFKEAALRCFLVEPGLHRGLAGEIIGELYPKRYLGTDKIGKVLSTNTKRAEFVGELAVSEPYEWGKRWRVKGEKANSACYGHAITLHAKWKWGSVENASFYLFKKVTFPLAVVDEREAGVHKSVEGKNDHGSDHSPYNLNHGRTWSPRWSSTLHGKVGARENFPGIATAEFGTKIGLWRENLDYVIIDEKRLVVLAYHSAKPLNADDARTDVHSIPVLNEGGKNDLVRDDEEKEKLFNVSGSSYNCGARAMTIERPLGALEHLASGTMVAIFGGPIVVAAIKCGRFYLYDNLGAAPVAMPLSIADDEKVHTTYMLFRALENLVMGAGGEEPRDMFLSESDFNAEVATLDNAGNSDVSTLGAPENAINFTEAADDYNVAKTSYPMTGRDFDVWSNALTEFSKRKTYPLSAHTNSKESIANAHWSTYPIHVVCNVGLAYSGLGVWKSGLLAHLKDADVPTVEPICNKDACDTKNETDSNSSKVSDPDREVFISEYLSKIGDADAGVIGMSLAAAHKKVDFGPAITCLGLWFNNVDLSGEFVELNLHNDRYEIAGYPHALSLTIGSENILDLPYAMDVIAILIESKNLPDKPPKKKTGGFVVCLLVEASGSLTDVLKPKTMCDDAGGPLDGSFSNLNVWAKYTGTHEIRRTHCHCAKGIADEEELLGLIAALPADATLGLVMTGNRIKKYISNIVLRVEKDHYSLSKTSSDDELPMRASGENTIGGCGVWEGTLEDPKIHYYGGLDPWTMEEEPRPLPEAPRMKALIGTRSIYLHNNSAANAPLHIIISAPYDIDALERGSTSGWGDGPINEYWIIVFDGYPKLTLKDVVMFTLYRFVVESRGESIKDNILTTYGRLMNETFPTAAPHKGFKYCLGNFKGSATTFKYKVTIDLPLLAKATTVAHFVAWGTLYDVAFLNSNDVIIWPYAISLVMAHLILRLGVPPYGRSIGFDPKEIVIGHCSRRGNLELELLGEDEAVLHMKACEKSKRLYKHVKRNANIGPAENIKGAKEPPDTLKVNPGHVTPVVIHGDHLVTSENLRRPMLHEALSIGLPLPIRIFLSEDIHVTRLPLEIEPIKKSPKPLVRAMKWCNESERLGGRSPKSERENPNDRTLRTVFGYIDYMGGKGDHLEDREDLDHEMYMKGMLTGLPTYESDGHIYYGLTSGEERHASGRPRELIFNGIGVTRGIWPRRPVLTWFIPKAPINARPYEGNGRVDSTPIRTFLPGPSHLIRACVCYSRGGNMMHRSGNIAEHVALVMPTEDSNEVARLNRTAAMSAKGIEIGASSDRVGNISGEYPWNRPWKFIKYKLLVDPINARASLWLSTVLKEKSINDKVEPRVSKVDGIFAKTSAENKDKLPSCKFRAATSMPPYPPDFDIFLPAALGCVDLFMVLWVCLEEKMLRHEPTPLCHVIGLVANIEYDVMSPDSASDTEGNGVLFSLGAGKDEDIYAIIPLSRAAEMLTYISEYTLASWDLLTYDLHKEESAGPKGAGYILGVDLSEIRSYSVDYFREEDLTHGDLDDVSKNTVLFPISWNALFILMESRINRLAVKKTEVGVCVEKGHSIYGPFWMHHTFPKNKLNDWGEPLPLATGLNIEASDVDVFHSNDAGFVFWTTINALVDTYGPGFKDPVHANTEHAYPIEIAWFSDSTTSVLALTVDKFGRTDMLTFTGMGSDKVILLFRMDNRNKYDDMEELLVSNGAYSEVWMPSCKAINDLLVHFRHPTVIKGTDFHTMSSGAKPDVPPYNANLDTAYIDCEDGVITHTSVPTNLGAFDGGAWPTPFGLRAETFDFDIYSVSPPAKVAIRLVVNSGFTGVNFSGGGILAYTFFSSREDSLHFVPRFYSVPCGKIFEARTYLMTVTYLELSTMISLIVYKLFIERNVSHPTVSIIFLVEIHFLGEANIAILWACGSESDVSDSSTSTGPSKKSNEKRHEAGIEAEDRVSIGKIAGVENSFNYYYIRAAKYSGGIGLGLYKLPCLISGHVVCPKETGLGTTKEFGVHSLGLCEKAFDISLAVMPRMEGLGSPTGDTKLGSTPPIDDDIKVLRTNAKLAEDNADGTGANEDSSLDAAHELPVATGELDSSTYYVTLEFSMNAISNHAETFGPGLFTVLVNNNASTHDTYDECFSWYDGPMESYVLAVLVSGWLEADELNGSVPVVAGDTLIGNFKINSAPCGDINFTGSLPIKDRLNRANVSPGWLIGLTLILRIVSLPGYIHCYEANRESIKYTYMVLAELNLFCVGADMLDAYPRIALYHDSAMASNIPVGDKALVASEEVYASNKELGGGETTMVVSCGDADDDLTSIFPMIRGEKGLEPVNMGFMKSSVAFLEMTATEPYVTPLYEKAGRDKGLLAHIDNGDPGHVLKAEVGESGFIKYVNDLLGHSGLFRRWGCLPDKFGVAEPEFTKNSITDIPILSMTLELGVRDEPGGNDINLASPGNKSGCGHILYKPGEIIAVVEMTRAVITALGRLGRPFDTVCPNRHDDGALVRKRKGWEDPNTGSVEHLVPLPYDFVPSRTMLATAHGKGANKYIEKTGFVNDLHVTWYRLGTVKPIFIYLNSCFDNFAGGLITTLVALPYPAPSCANGEVCLELTLYGYTPVSNGVFYAKNTIMSLNMTPLNAELYSEGDIRTRVVGPEFAPEVLFPEAGRYASLSDSLAGHNLNTLCGDEYARRFISAGKSGTMWEGRWLGGRSNNVGNHVLLGSEAKSHMIILPAIVASTETLPRLGETDEDLLAVAMCLMFVNTLFIALGVKKACLSMLIYSELYGDRDVDGNGHLYKMKFLAIGWLTELGKPAIFTRYVKSLKKLLVVLGKGGSMVESLAVKSLTSTYNTVGGSFLMK"

out <- pairwiseAlignment(pattern = x, 
                                   subject = y,
                    type = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening = 5,
                    gapExtension = 2)
out

  score.i         <- score(out)
  alignment.seq.i <- toString(out)
  length.i        <- nchar(alignment.seq.i)
```


```{r}


```



```{r}


for(i in 1:iterations){
  
  seq.n.i <- sample(x = robinson.aafreq$aa, 
                  size = seq.length, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
  seq.n.i <- paste(seq.n.i,sep = "",collapse = "")
  
  seq.m.i <- sample(x = robinson.aafreq$aa, 
                  size = seq.length, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
  seq.m.i <- paste(seq.m.i,sep = "",collapse = "")
  
  alignment.i <- pairwiseAlignment(pattern = seq.n.i, 
                                   subject = seq.m.i,
                    type = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening = -12,
                    gapExtension = -1)
  alignment.i
  alignment.seq.i <- toString(alignment.i)
  nchar(alignment.seq.i)
  
  score.i         <- score(alignment.i)
  alignment.seq.i <- toString(alignment.i)
  length.i        <- nchar(alignment.seq.i)

  
   random.scores[i,"length.i"] <- length.i
   random.scores[i,"score.i"] <- score.i
```


```{r}
library(Biostrings)
iterations <- 10000
seq.length <- 2981


for(i in 1:iterations){
  random.scores <- data.frame(interation = 1:iterations,
                         length.i = NA,
                         score.i = NA) }
```

```{r}
library(foreach)
library(doParallel)
```


```{r}
detectCores()
getDoParWorkers()
registerDoParallel(cores=3)
b <- 

summary(x) #191
summary(y) #245
summary(z) #314
summary(a) #403
summary(b)

hist(y[,"score.i"])
max(table(y[,"score.i"]))



write.csv(x,file = "x.csv")

```










```{r}
m <- n <- seq.lengths[1]
iterations <- 10000
nm191a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```



```{r}
m <- n <- seq.lengths[1]
iterations <- 10000
nm191b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```



```{r}
m <- n <- seq.lengths[2]
iterations <- 10000
nm245 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


```{r}
m <- n <- seq.lengths[3]
iterations <- 10000
nm314a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```



```{r}
m <- n <- seq.lengths[3]
iterations <- 10000
nm314b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```




```{r}
m <- n <- seq.lengths[4]
iterations <- 10000
nm403 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```



```{r}
m <- n <- seq.lengths[5]
iterations <- 10000
nm518 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


```{r}
m <- n <- seq.lengths[6]
iterations <- 10000
nm665a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


```{r}
m <- n <- seq.lengths[6]
iterations <- 10000
nm665b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```




```{r}
m <- n <- seq.lengths[7]
iterations <- 10000
nm854 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


```{r}
m <- n <- seq.lengths[8]
iterations <- 10000
nm1097 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```




```{r}
m <- n <- seq.lengths[9]
iterations <- 10000
nm1408a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```




```{r}
m <- n <- seq.lengths[9]
iterations <- 10000
nm1408b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```


```{r}
m <- n <- seq.lengths[10]
iterations <- 10000
nm1808 <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```



```{r}
m <- n <- seq.lengths[11]
iterations <- 10000
nm2322a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```

```{r}
m <- n <- seq.lengths[11]
iterations <- 10000
nm2322b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)

```




Par version
```{r}
m <- n <- seq.lengths[12]
iterations <- 10000
nm2981.par.a <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```

```{r}
m <- n <- seq.lengths[12]
iterations <- 10000
nm2981.par.b <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```

```{r}
m <- n <- seq.lengths[12]
iterations <- 10000
nm2981.par.c <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


```{r}
m <- n <- seq.lengths[12]
iterations <- 10000
nm2981.par.d <- foreach(i = 1:iterations,.combine='rbind',.packages='Biostrings') %dopar%     
        random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)


```


non par varions
```{r}
m <- n <- seq.lengths[12]
iterations <- 10000
nm2981.nonpar <- data.frame(interation = 1:iterations,
                         length.i = NA,
                         score.i = NA)
  
for(i in 1:iterations){

  out <- random_alignments_compare(seq.length1 = m, 
                          seq.length2 = n, 
                          aas = robinson.aafreq$aa,
                          aas.freqs = robinson.aafreq$aa.freq.sum.aa.freq.)
  
  nm2981.nonpar[,i] <- out
}
```



```{r}
summary(nm403)
summary(nm1097)
summary(nm1408)
summary(nm2981)
summary(nm2981.nonpar)
```































