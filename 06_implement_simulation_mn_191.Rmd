---
title: '[Re] Local alignment statistics - Simulate full set of data'
author: "Nathan Brouwer"
date: "11/18/2019"
output:
  pdf_document: default
  html_document: default
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Simulate data for 1 sub-experiment as for() loop

In this sections the basic computations of the experiment are iterated in order to generate the date for one row of the table.  This requires the Robinson and Robinson amino acid table to be loaded from the appropriate script.

### Run experiment for n = m = 191 amino acids

The first row of Table 1, page 465 indicates that simulated sequences of 191 amino acids were investigated.  **In the original simulation 10000 iterations were carried out; we'll do just 1000.**

#### for() loop for 191 amino acids

```{r}
# load libraries
library(Biostrings)

# load amino acid frequencies
robinson.aafreq <- read.csv(file = "robinson_aafreq.csv")

# create dataframe to store scores and lengths
random.scores.191 <- data.frame(interation = 1:1000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 191, 
                         seq.length2 = 191)

# for loop

for(i in 1:1000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 191, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 191, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.191$score.i[i]  <- score.i
 random.scores.191$length.i[i] <- length.i

}

```

The results of one full set of simulations look like this:

```{r}
head(random.scores.191)

summary(random.scores.191)
```

The distribution of scores can be plotted with hist()
```{r}
hist(random.scores.191$score.i)
```

Save the output

```{r}
write.csv(random.scores.191, file = "random_scores_191.csv")
```


```{r}

```

