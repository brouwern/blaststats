---
title: "[Re] Local alignment statistics - Simulate all data"
author: "Nathan Brouwer"
date: "11/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Simulate whole experiment

In this section of the script we generate the raw score data for each row of Table 1.  I've copy, pasted, and modified by hand the code for each row.

The original table ran simulations for these sequence lengths:

191, 245, 314, 403, 518, 665, 854, 1097, 1408, 1808, 2322, 2981

The code is set for 2000 iterations; the original paper did 10000


I'm curious how long this will take, so I'll record when I start the simulations

```{r}
sim.start <- Sys.time()
```

## Preliminaries
```{r}
# load libraries
library(Biostrings)

# load amino acid frequencies
robinson.aafreq <- read.csv(file = "robinson_aafreq.csv")

```



### for() loop for 191 amino acids

```{r}


# create dataframe to store scores and lengths
random.scores.191 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 191, 
                         seq.length2 = 191)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 191, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 191, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.191$score.i[i]  <- score.i
 random.scores.191$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")

```


### for() loop for 245 amino acids

```{r}
# create dataframe to store scores
random.scores.245 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 245, 
                         seq.length2 = 245)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 245, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 245, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.245$score.i[i]  <- score.i
 random.scores.245$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```



### for() loop for 314 amino acids

```{r}
# create dataframe to store scores
random.scores.314 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 314, 
                         seq.length2 = 314)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 314, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 314, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.314$score.i[i]  <- score.i
 random.scores.314$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```




### for() loop for 403 amino acids

```{r}
# create dataframe to store scores
random.scores.403 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 403, 
                         seq.length2 = 403)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 403, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 403, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.403$score.i[i]  <- score.i
 random.scores.403$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```




### for() loop for 518 amino acids

```{r}
# create dataframe to store scores
random.scores.518<- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 518, 
                         seq.length2 = 518)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 518, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 518, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.518$score.i[i]  <- score.i
 random.scores.518$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```




### for() loop for 665 amino acids

```{r}
# create dataframe to store scores
random.scores.665<- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 665, 
                         seq.length2 = 665)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 665, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 665, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.665$score.i[i]  <- score.i
 random.scores.665$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```


### for() loop for 854 amino acids

```{r}
# create dataframe to store scores
random.scores.854<- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 854, 
                         seq.length2 = 854)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 854, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 854, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.854$score.i[i]  <- score.i
 random.scores.854$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```



### for() loop for 1097 amino acids

```{r}
# create dataframe to store scores
random.scores.1097 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 1097, 
                         seq.length2 = 1097)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 1097, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 1097, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.1097$score.i[i]  <- score.i
 random.scores.1097$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```



### for() loop for 1408 amino acids

```{r}
# create dataframe to store scores
random.scores.1408 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 1408, 
                         seq.length2 = 1408)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 1408, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 1408, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.1408$score.i[i]  <- score.i
 random.scores.1408$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```



### for() loop for 1808 amino acids

```{r}
# create dataframe to store scores
random.scores.1808 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 1808, 
                         seq.length2 = 1808)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 1808, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 1808, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.1808$score.i[i]  <- score.i
 random.scores.1808$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```



### for() loop for 2322 amino acids

```{r}
# create dataframe to store scores
random.scores.2322 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 2322, 
                         seq.length2 = 2322)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size =  2322, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 2322, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.2322$score.i[i]  <- score.i
 random.scores.2322$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```





### for() loop for 2981 amino acids

```{r}
# create dataframe to store scores
random.scores.2981 <- data.frame(interation = 1:10000,
                         score.i = NA,
                         length.i = NA,
                         seq.length1 = 2981, 
                         seq.length2 = 2981)

# for loop

for(i in 1:10000){
 seq1 <- sample(x = robinson.aafreq$aa1, 
                  size = 2981, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq1 <- paste(seq1, sep = "",
                  collapse = "")  
 
 seq2 <- sample(x = robinson.aafreq$aa1, 
                  size = 2981, 
                  replace = TRUE, 
                  prob = robinson.aafreq$aa.freq)
 seq2 <- paste(seq2, sep = "",
                  collapse = "")
 
 alignment.i <- pairwiseAlignment(pattern = seq1, 
                                   subject = seq2,
                    type               = "local",
                    substitutionMatrix = "BLOSUM62",
                    gapOpening         = 12,
                    gapExtension       = 1)
 score.i         <- score(alignment.i)
 
 # cat("Iteration ", i)
 # cat("score ", score.i)
 # cat("\n")
 
 alignment.seq.i <- toString(alignment.i)
 
 length.i        <- nchar(alignment.seq.i)
 
 
 random.scores.2981$score.i[i]  <- score.i
 random.scores.2981$length.i[i] <- length.i

}

save.image(file = "full_experiment.RData")
```


This will record the end of the experiment

```{r}
sim.end <- Sys.time()
```

## Save all data

Normally we save data in dataframes.  Here, I'm going to save all my R objects to memory.

```{r}
save.image(file = "full_experiment.RData")
```

